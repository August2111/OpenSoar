 include/proj/coordinateoperation.hpp               | 24 ++++++++
 include/proj/coordinates.hpp                       |  2 +
 include/proj/coordinatesystem.hpp                  |  6 ++
 include/proj/crs.hpp                               | 40 ++++++++++++
 include/proj/datum.hpp                             | 20 ++++++
 include/proj/io.hpp                                |  4 ++
 src/iso19111/c_api.cpp                             | 16 +++++
 src/iso19111/common.cpp                            | 16 +++++
 src/iso19111/coordinates.cpp                       |  4 ++
 src/iso19111/coordinatesystem.cpp                  | 16 +++++
 src/iso19111/crs.cpp                               | 72 ++++++++++++++++++++++
 src/iso19111/datum.cpp                             | 44 +++++++++++++
 src/iso19111/io.cpp                                | 14 +++++
 src/iso19111/metadata.cpp                          |  6 ++
 src/iso19111/operation/concatenatedoperation.cpp   |  4 ++
 src/iso19111/operation/conversion.cpp              |  2 +
 .../operation/coordinateoperation_internal.hpp     | 10 +++
 src/iso19111/operation/oputils.cpp                 |  4 ++
 src/iso19111/operation/projbasedoperation.cpp      |  4 ++
 src/iso19111/operation/singleoperation.cpp         | 18 ++++++
 src/iso19111/operation/transformation.cpp          | 12 ++++
 src/lib_proj.cmake                                 |  2 -
 src/pj_list.h                                      |  2 +
 src/transformations/defmodel.cpp                   |  4 ++
 src/transformations/defmodel.hpp                   |  2 +
 src/transformations/defmodel_impl.hpp              |  4 ++
 26 files changed, 350 insertions(+), 2 deletions(-)

diff --git a/include/proj/coordinateoperation.hpp b/include/proj/coordinateoperation.hpp
index af6802fc..a03e3cba 100644
--- a/include/proj/coordinateoperation.hpp
+++ b/include/proj/coordinateoperation.hpp
@@ -354,9 +354,11 @@ class PROJ_GCC_DLL OperationParameter final : public GeneralOperationParameter {
     PROJ_OPAQUE_PRIVATE_DATA
     OperationParameter &operator=(const OperationParameter &other) = delete;
 
+#ifdef ENABLE_JSON
     // cppcheck-suppress functionStatic
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
+#endif // ENABLE_JSON
 };
 
 // ---------------------------------------------------------------------------
@@ -378,11 +380,13 @@ class PROJ_GCC_DLL GeneralParameterValue : public util::BaseObject,
     //! @cond Doxygen_Suppress
     PROJ_DLL ~GeneralParameterValue() override;
 
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override = 0; // throw(io::FormattingException)
 
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override = 0; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL bool _isEquivalentTo(
         const util::IComparable *other,
@@ -399,10 +403,12 @@ class PROJ_GCC_DLL GeneralParameterValue : public util::BaseObject,
     friend class Conversion;
     friend class SingleOperation;
     friend class PointMotionOperation;
+#ifdef ENABLE_JSON
     PROJ_INTERNAL virtual void _exportToWKT(io::WKTFormatter *formatter,
                                             const MethodMapping *mapping)
         const = 0; // throw(io::FormattingException)
                    //! @endcond
+#endif // ENABLE_JSON
 
   private:
     PROJ_OPAQUE_PRIVATE_DATA
@@ -450,9 +456,11 @@ class PROJ_GCC_DLL ParameterValue final : public util::BaseObject,
     //! @cond Doxygen_Suppress
     PROJ_DLL ~ParameterValue() override;
 
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
     //! @endcond
+#endif // ENABLE_JSON
 
     PROJ_DLL static ParameterValueNNPtr
     create(const common::Measure &measureIn);
@@ -527,11 +535,13 @@ class PROJ_GCC_DLL OperationParameterValue final
                             const common::UnitOfMeasure *&unit,
                             int &paramEPSGCode);
 
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
 
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL bool _isEquivalentTo(
         const util::IComparable *other,
@@ -547,9 +557,11 @@ class PROJ_GCC_DLL OperationParameterValue final
     PROJ_INTERNAL OperationParameterValue(const OperationParameterValue &other);
     INLINED_MAKE_SHARED
 
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter,
                                     const MethodMapping *mapping)
         const override; // throw(io::FormattingException)
+#endif // ENABLE_JSON
 
   private:
     PROJ_OPAQUE_PRIVATE_DATA
@@ -596,12 +608,14 @@ class PROJ_GCC_DLL OperationMethod : public common::IdentifiedObject,
 
     PROJ_DLL int getEPSGCode() PROJ_PURE_DECL;
 
+#ifdef ENABLE_JSON
     //! @cond Doxygen_Suppress
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
 
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL bool _isEquivalentTo(
         const util::IComparable *other,
@@ -964,10 +978,12 @@ class PROJ_GCC_DLL Conversion : public SingleOperation {
 
     PROJ_DLL CoordinateOperationNNPtr inverse() const override;
 
+#ifdef ENABLE_JSON
     //! @cond Doxygen_Suppress
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
     //! @endcond
+#endif // ENABLE_JSON
 
     PROJ_DLL bool isUTM(int &zone, bool &north) const;
 
@@ -1502,8 +1518,10 @@ class PROJ_GCC_DLL Conversion : public SingleOperation {
         _exportToPROJString(io::PROJStringFormatter *formatter)
             const override; // throw(FormattingException)
 
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL const char *getESRIMethodName() const;
 
@@ -1725,11 +1743,13 @@ class PROJ_GCC_DLL Transformation : public SingleOperation {
 
     PROJ_INTERNAL const std::string &getHeightToGeographic3DFilename() const;
 
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
 
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL TransformationNNPtr shallowClone() const;
 
@@ -1894,10 +1914,12 @@ class PROJ_GCC_DLL ConcatenatedOperation final : public CoordinateOperation {
 
     PROJ_PRIVATE :
 
+#ifdef ENABLE_JSON
         //! @cond Doxygen_Suppress
         PROJ_INTERNAL void
         _exportToWKT(io::WKTFormatter *formatter)
             const override; // throw(io::FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL bool _isEquivalentTo(
         const util::IComparable *other,
@@ -1905,8 +1927,10 @@ class PROJ_GCC_DLL ConcatenatedOperation final : public CoordinateOperation {
             util::IComparable::Criterion::STRICT,
         const io::DatabaseContextPtr &dbContext = nullptr) const override;
 
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL static void
     fixSteps(const crs::CRSNNPtr &concatOpSourceCRS,
diff --git a/include/proj/coordinates.hpp b/include/proj/coordinates.hpp
index d5350c06..12c1fe13 100644
--- a/include/proj/coordinates.hpp
+++ b/include/proj/coordinates.hpp
@@ -85,12 +85,14 @@ class PROJ_GCC_DLL CoordinateMetadata : public util::BaseObject,
     PROJ_PRIVATE :
         //! @cond Doxygen_Suppress
 
+#ifdef ENABLE_JSON
         PROJ_INTERNAL void
         _exportToWKT(io::WKTFormatter *formatter)
             const override; // throw(io::FormattingException)
 
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     //! @endcond
 
diff --git a/include/proj/coordinatesystem.hpp b/include/proj/coordinatesystem.hpp
index 8f92dbb4..9b8796a9 100644
--- a/include/proj/coordinatesystem.hpp
+++ b/include/proj/coordinatesystem.hpp
@@ -168,6 +168,7 @@ class PROJ_GCC_DLL Meridian : public common::IdentifiedObject,
     // non-standard
     PROJ_DLL static MeridianNNPtr create(const common::Angle &longitudeIn);
 
+#ifdef ENABLE_JSON
     //! @cond Doxygen_Suppress
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
@@ -175,6 +176,7 @@ class PROJ_GCC_DLL Meridian : public common::IdentifiedObject,
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
                         //! @endcond
+#endif // ENABLE_JSON
 
   protected:
 #ifdef DOXYGEN_ENABLED
@@ -243,6 +245,7 @@ class PROJ_GCC_DLL CoordinateSystemAxis final : public common::IdentifiedObject,
                 util::IComparable::Criterion::STRICT,
             const io::DatabaseContextPtr &dbContext = nullptr) const override;
 
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter, int order,
                                     bool disableAbbrev) const;
 
@@ -251,6 +254,7 @@ class PROJ_GCC_DLL CoordinateSystemAxis final : public common::IdentifiedObject,
 
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL static std::string normalizeAxisName(const std::string &str);
 
@@ -298,6 +302,7 @@ class PROJ_GCC_DLL CoordinateSystem : public common::IdentifiedObject,
 
     PROJ_PRIVATE :
 
+#ifdef ENABLE_JSON
         //! @cond Doxygen_Suppress
         PROJ_INTERNAL void
         _exportToWKT(io::WKTFormatter *formatter)
@@ -305,6 +310,7 @@ class PROJ_GCC_DLL CoordinateSystem : public common::IdentifiedObject,
 
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL virtual std::string getWKT2Type(bool) const = 0;
 
diff --git a/include/proj/crs.hpp b/include/proj/crs.hpp
index 4f66d562..0dd3d039 100644
--- a/include/proj/crs.hpp
+++ b/include/proj/crs.hpp
@@ -323,14 +323,18 @@ class PROJ_GCC_DLL GeodeticCRS : virtual public SingleCRS,
     PROJ_INTERNAL void
     addAngularUnitConvertAndAxisSwap(io::PROJStringFormatter *formatter) const;
 
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL void _exportToPROJString(io::PROJStringFormatter *formatter)
         const override; // throw(FormattingException)
 
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL bool _isEquivalentTo(
         const util::IComparable *other,
@@ -424,8 +428,10 @@ class PROJ_GCC_DLL GeographicCRS : public GeodeticCRS {
         _exportToPROJString(io::PROJStringFormatter *formatter)
             const override; // throw(FormattingException)
 
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_DLL bool is2DPartOf3D(
         util::nn<const GeographicCRS *> other,
@@ -516,14 +522,18 @@ class PROJ_GCC_DLL VerticalCRS : virtual public SingleCRS,
     PROJ_INTERNAL const datum::VerticalReferenceFrameNNPtr
     datumNonNull(const io::DatabaseContextPtr &dbContext) const;
 
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL void _exportToPROJString(io::PROJStringFormatter *formatter)
         const override; // throw(FormattingException)
 
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL bool _isEquivalentTo(
         const util::IComparable *other,
@@ -582,8 +592,10 @@ class PROJ_GCC_DLL DerivedCRS : virtual public SingleCRS {
         PROJ_INTERNAL const operation::ConversionNNPtr &
         derivingConversionRef() PROJ_PURE_DECL;
 
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     //! @endcond
 
@@ -596,9 +608,11 @@ class PROJ_GCC_DLL DerivedCRS : virtual public SingleCRS {
 
     PROJ_INTERNAL void setDerivingConversionCRS();
 
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void baseExportToWKT(
         io::WKTFormatter *formatter, const std::string &keyword,
         const std::string &baseKeyword) const; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL bool _isEquivalentTo(
         const util::IComparable *other,
@@ -671,11 +685,13 @@ class PROJ_GCC_DLL ProjectedCRS final : public DerivedCRS,
         const std::vector<cs::CoordinateSystemAxisNNPtr> &axisListIn,
         io::PROJStringFormatter *formatter, bool axisSpecFound);
 
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
 
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_FOR_TEST ProjectedCRSNNPtr alterParametersLinearUnit(
         const common::UnitOfMeasure &unit, bool convertToNewUnit) const;
@@ -742,12 +758,14 @@ class PROJ_GCC_DLL TemporalCRS : virtual public SingleCRS {
            const datum::TemporalDatumNNPtr &datumIn,
            const cs::TemporalCSNNPtr &csIn);
 
+#ifdef ENABLE_JSON
     //! @cond Doxygen_Suppress
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
 
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     //! @endcond
 
@@ -804,12 +822,14 @@ class PROJ_GCC_DLL EngineeringCRS : virtual public SingleCRS {
            const datum::EngineeringDatumNNPtr &datumIn,
            const cs::CoordinateSystemNNPtr &csIn);
 
+#ifdef ENABLE_JSON
     //! @cond Doxygen_Suppress
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
 
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     //! @endcond
 
@@ -865,12 +885,14 @@ class PROJ_GCC_DLL ParametricCRS : virtual public SingleCRS {
            const datum::ParametricDatumNNPtr &datumIn,
            const cs::ParametricCSNNPtr &csIn);
 
+#ifdef ENABLE_JSON
     //! @cond Doxygen_Suppress
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
 
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     //! @endcond
 
@@ -938,10 +960,12 @@ class PROJ_GCC_DLL CompoundCRS final : public CRS,
     PROJ_DLL std::list<std::pair<CompoundCRSNNPtr, int>>
     identify(const io::AuthorityFactoryPtr &authorityFactory) const;
 
+#ifdef ENABLE_JSON
     //! @cond Doxygen_Suppress
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
     //! @endcond
+#endif // ENABLE_JSON
 
     PROJ_DLL static CompoundCRSNNPtr
     create(const util::PropertyMap &properties,
@@ -964,8 +988,10 @@ class PROJ_GCC_DLL CompoundCRS final : public CRS,
     PROJ_INTERNAL void _exportToPROJString(io::PROJStringFormatter *formatter)
         const override; // throw(FormattingException)
 
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL CRSNNPtr _shallowClone() const override;
 
@@ -1026,10 +1052,12 @@ class PROJ_GCC_DLL BoundCRS final : public CRS,
     PROJ_DLL const operation::TransformationNNPtr &
     transformation() PROJ_PURE_DECL;
 
+#ifdef ENABLE_JSON
     //! @cond Doxygen_Suppress
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
     //! @endcond
+#endif // ENABLE_JSON
 
     PROJ_DLL static BoundCRSNNPtr
     create(const util::PropertyMap &properties, const CRSNNPtr &baseCRSIn,
@@ -1058,8 +1086,10 @@ class PROJ_GCC_DLL BoundCRS final : public CRS,
     PROJ_INTERNAL void _exportToPROJString(io::PROJStringFormatter *formatter)
         const override; // throw(FormattingException)
 
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL bool _isEquivalentTo(
         const util::IComparable *other,
@@ -1121,6 +1151,7 @@ class PROJ_GCC_DLL DerivedGeodeticCRS final : public GeodeticCRS,
            const operation::ConversionNNPtr &derivingConversionIn,
            const cs::SphericalCSNNPtr &csIn);
 
+#ifdef ENABLE_JSON
     //! @cond Doxygen_Suppress
     void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
@@ -1129,6 +1160,7 @@ class PROJ_GCC_DLL DerivedGeodeticCRS final : public GeodeticCRS,
     _exportToJSON(io::JSONFormatter *formatter) const override {
         return DerivedCRS::_exportToJSON(formatter);
     }
+#endif // ENABLE_JSON
 
     //! @endcond
 
@@ -1205,6 +1237,7 @@ class PROJ_GCC_DLL DerivedGeographicCRS final : public GeographicCRS,
     demoteTo2D(const std::string &newName,
                const io::DatabaseContextPtr &dbContext) const;
 
+#ifdef ENABLE_JSON
     //! @cond Doxygen_Suppress
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
@@ -1213,6 +1246,7 @@ class PROJ_GCC_DLL DerivedGeographicCRS final : public GeographicCRS,
     _exportToJSON(io::JSONFormatter *formatter) const override {
         return DerivedCRS::_exportToJSON(formatter);
     }
+#endif // ENABLE_JSON
 
     //! @endcond
 
@@ -1284,9 +1318,11 @@ class PROJ_GCC_DLL DerivedProjectedCRS final : public DerivedCRS {
     demoteTo2D(const std::string &newName,
                const io::DatabaseContextPtr &dbContext) const;
 
+#ifdef ENABLE_JSON
     //! @cond Doxygen_Suppress
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL void
     addUnitConvertAndAxisSwap(io::PROJStringFormatter *formatter) const;
@@ -1347,6 +1383,7 @@ class PROJ_GCC_DLL DerivedVerticalCRS final : public VerticalCRS,
            const operation::ConversionNNPtr &derivingConversionIn,
            const cs::VerticalCSNNPtr &csIn);
 
+#ifdef ENABLE_JSON
     //! @cond Doxygen_Suppress
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
@@ -1355,6 +1392,7 @@ class PROJ_GCC_DLL DerivedVerticalCRS final : public VerticalCRS,
     _exportToJSON(io::JSONFormatter *formatter) const override {
         return DerivedCRS::_exportToJSON(formatter);
     }
+#endif // ENABLE_JSON
 
     //! @endcond
 
@@ -1439,6 +1477,7 @@ class PROJ_GCC_DLL DerivedCRSTemplate final : public DerivedCRSTraits::BaseType,
            const operation::ConversionNNPtr &derivingConversionIn,
            const CSNNPtr &csIn);
 
+#ifdef ENABLE_JSON
     //! @cond Doxygen_Suppress
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
@@ -1448,6 +1487,7 @@ class PROJ_GCC_DLL DerivedCRSTemplate final : public DerivedCRSTraits::BaseType,
         return DerivedCRS::_exportToJSON(formatter);
     }
     //! @endcond
+#endif // ENABLE_JSON
 
   protected:
     PROJ_INTERNAL
diff --git a/include/proj/datum.hpp b/include/proj/datum.hpp
index 3fdc4fcd..f3994b96 100644
--- a/include/proj/datum.hpp
+++ b/include/proj/datum.hpp
@@ -144,12 +144,14 @@ class PROJ_GCC_DLL DatumEnsemble final : public common::ObjectUsage,
         const std::vector<DatumNNPtr> &datumsIn,
         const metadata::PositionalAccuracyNNPtr &accuracy); // throw(Exception)
 
+#ifdef ENABLE_JSON
     //! @cond Doxygen_Suppress
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
 
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(io::FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_FOR_TEST DatumNNPtr
     asDatum(const io::DatabaseContextPtr &dbContext) const;
@@ -214,11 +216,13 @@ class PROJ_GCC_DLL PrimeMeridian final : public common::IdentifiedObject,
         _exportToPROJString(io::PROJStringFormatter *formatter)
             const override; // throw(FormattingException)
 
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
 
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(io::FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL bool _isEquivalentTo(
         const util::IComparable *other,
@@ -319,6 +323,7 @@ class PROJ_GCC_DLL Ellipsoid final : public common::IdentifiedObject,
     PROJ_DLL static const EllipsoidNNPtr GRS1980;
 
     PROJ_PRIVATE :
+#ifdef ENABLE_JSON
         //! @cond Doxygen_Suppress
         PROJ_INTERNAL void
         _exportToWKT(io::WKTFormatter *formatter)
@@ -326,6 +331,7 @@ class PROJ_GCC_DLL Ellipsoid final : public common::IdentifiedObject,
 
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(io::FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL bool _isEquivalentTo(
         const util::IComparable *other,
@@ -431,11 +437,13 @@ class PROJ_GCC_DLL GeodeticReferenceFrame : public Datum {
     PROJ_DLL static const GeodeticReferenceFrameNNPtr EPSG_6326; // WGS 84
 
     //! @cond Doxygen_Suppress
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
 
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL bool _isEquivalentTo(
         const util::IComparable *other,
@@ -517,9 +525,11 @@ class PROJ_GCC_DLL DynamicGeodeticReferenceFrame final
             util::IComparable::Criterion::STRICT,
         const io::DatabaseContextPtr &dbContext = nullptr) const override;
 
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
                         //! @endcond
+#endif // ENABLE_JSON
 
   protected:
 #ifdef DOXYGEN_ENABLED
@@ -612,11 +622,13 @@ class PROJ_GCC_DLL VerticalReferenceFrame : public Datum {
         const util::IComparable *other, util::IComparable::Criterion criterion,
         const io::DatabaseContextPtr &dbContext) const;
 
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
 
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL const std::string &getWKT1DatumType() const;
 
@@ -678,9 +690,11 @@ class PROJ_GCC_DLL DynamicVerticalReferenceFrame final
             util::IComparable::Criterion::STRICT,
         const io::DatabaseContextPtr &dbContext = nullptr) const override;
 
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
                         //! @endcond
+#endif // ENABLE_JSON
 
   protected:
 #ifdef DOXYGEN_ENABLED
@@ -732,11 +746,13 @@ class PROJ_GCC_DLL TemporalDatum final : public Datum {
            const std::string &calendarIn);
 
     //! @cond Doxygen_Suppress
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
 
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL bool _isEquivalentTo(
         const util::IComparable *other,
@@ -784,11 +800,13 @@ class PROJ_GCC_DLL EngineeringDatum final : public Datum {
                util::optional<std::string>());
 
     //! @cond Doxygen_Suppress
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
 
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL bool _isEquivalentTo(
         const util::IComparable *other,
@@ -832,11 +850,13 @@ class PROJ_GCC_DLL ParametricDatum final : public Datum {
                util::optional<std::string>());
 
     //! @cond Doxygen_Suppress
+#ifdef ENABLE_JSON
     PROJ_INTERNAL void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
 
     PROJ_INTERNAL void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     PROJ_INTERNAL bool _isEquivalentTo(
         const util::IComparable *other,
diff --git a/include/proj/io.hpp b/include/proj/io.hpp
index 7c473af3..87790023 100644
--- a/include/proj/io.hpp
+++ b/include/proj/io.hpp
@@ -605,6 +605,7 @@ class PROJ_GCC_DLL JSONFormatter {
 /** \brief Interface for an object that can be exported to JSON. */
 class PROJ_GCC_DLL IJSONExportable {
   public:
+#ifdef ENABLE_JSON
     //! @cond Doxygen_Suppress
     PROJ_DLL virtual ~IJSONExportable();
     //! @endcond
@@ -620,6 +621,7 @@ class PROJ_GCC_DLL IJSONExportable {
         _exportToJSON(
             JSONFormatter *formatter) const = 0; // throw(FormattingException)
                                                  //! @endcond
+#endif // ENABLE_JSON
 };
 
 // ---------------------------------------------------------------------------
@@ -658,6 +660,7 @@ class PROJ_GCC_DLL ParsingException : public util::Exception {
 /** \brief Interface for an object that can be exported to WKT. */
 class PROJ_GCC_DLL IWKTExportable {
   public:
+#ifdef ENABLE_JSON
     //! @cond Doxygen_Suppress
     PROJ_DLL virtual ~IWKTExportable();
     //! @endcond
@@ -673,6 +676,7 @@ class PROJ_GCC_DLL IWKTExportable {
         _exportToWKT(
             WKTFormatter *formatter) const = 0; // throw(FormattingException)
                                                 //! @endcond
+#endif // ENABLE_JSON
 };
 
 // ---------------------------------------------------------------------------
diff --git a/src/iso19111/c_api.cpp b/src/iso19111/c_api.cpp
index ef4669ab..669bc32d 100644
--- a/src/iso19111/c_api.cpp
+++ b/src/iso19111/c_api.cpp
@@ -485,6 +485,8 @@ proj_context_get_database_structure(PJ_CONTEXT *ctx,
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 /** \brief Guess the "dialect" of the WKT string.
  *
  * @param ctx PROJ context, or NULL for default context
@@ -513,6 +515,8 @@ PJ_GUESSED_WKT_DIALECT proj_context_guess_wkt_dialect(PJ_CONTEXT *ctx,
     return PJ_GUESSED_NOT_WKT;
 }
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -642,6 +646,8 @@ PJ *proj_create(PJ_CONTEXT *ctx, const char *text) {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 /** \brief Instantiate an object from a WKT string.
  *
  * This function calls osgeo::proj::io::WKTParser::createFromWKT()
@@ -764,6 +770,8 @@ PJ *proj_create_from_wkt(PJ_CONTEXT *ctx, const char *wkt,
     return nullptr;
 }
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 /** \brief Instantiate an object from a database lookup.
@@ -1596,6 +1604,8 @@ const char *proj_get_id_code(const PJ *obj, int index) {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 /** \brief Get a WKT representation of an object.
  *
  * The returned string is valid while the input obj parameter is valid,
@@ -1703,6 +1713,8 @@ const char *proj_as_wkt(PJ_CONTEXT *ctx, const PJ *obj, PJ_WKT_TYPE type,
     }
 }
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 /** \brief Get a PROJ string representation of an object.
@@ -1800,6 +1812,8 @@ const char *proj_as_proj_string(PJ_CONTEXT *ctx, const PJ *obj,
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 /** \brief Get a PROJJSON string representation of an object.
  *
  * The returned string is valid while the input obj parameter is valid,
@@ -1868,6 +1882,8 @@ const char *proj_as_projjson(PJ_CONTEXT *ctx, const PJ *obj,
     }
 }
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 /** \brief Get the number of domains/usages for a given object.
diff --git a/src/iso19111/common.cpp b/src/iso19111/common.cpp
index 70f24049..1caf311f 100644
--- a/src/iso19111/common.cpp
+++ b/src/iso19111/common.cpp
@@ -177,6 +177,8 @@ const std::string &UnitOfMeasure::codeSpace() PROJ_PURE_DEFN {
  */
 const std::string &UnitOfMeasure::code() PROJ_PURE_DEFN { return d->code_; }
 
+#ifdef ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -299,6 +301,8 @@ void UnitOfMeasure::_exportToJSON(
     }
 }
 
+#endif // ENABLE_JSON
+
 //! @endcond
 
 // ---------------------------------------------------------------------------
@@ -869,6 +873,8 @@ void IdentifiedObject::setProperties(
     }
 }
 
+#ifdef ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -919,6 +925,8 @@ void IdentifiedObject::formatRemarks(JSONFormatter *formatter) const {
     }
 }
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 bool IdentifiedObject::_isEquivalentTo(
@@ -1018,6 +1026,8 @@ ObjectDomainNNPtr ObjectDomain::create(const optional<std::string> &scopeIn,
     return ObjectDomain::nn_make_shared<ObjectDomain>(scopeIn, extent);
 }
 
+#ifdef ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -1135,6 +1145,8 @@ void ObjectDomain::_exportToJSON(JSONFormatter *formatter) const {
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -1243,6 +1255,8 @@ void ObjectUsage::setProperties(
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 void ObjectUsage::baseExportToWKT(WKTFormatter *formatter) const {
     const bool isWKT2 = formatter->version() == WKTFormatter::Version::WKT2;
     if (isWKT2 && formatter->outputUsage()) {
@@ -1292,6 +1306,8 @@ void ObjectUsage::baseExportToJSON(JSONFormatter *formatter) const {
     formatRemarks(formatter);
 }
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
diff --git a/src/iso19111/coordinates.cpp b/src/iso19111/coordinates.cpp
index 6f26f75d..1b08d255 100644
--- a/src/iso19111/coordinates.cpp
+++ b/src/iso19111/coordinates.cpp
@@ -228,6 +228,8 @@ CoordinateMetadata::promoteTo3D(const std::string &newName,
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void CoordinateMetadata::_exportToWKT(io::WKTFormatter *formatter) const {
     if (formatter->version() != io::WKTFormatter::Version::WKT2 ||
@@ -269,6 +271,8 @@ void CoordinateMetadata::_exportToJSON(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 } // namespace coordinates
 
 NS_PROJ_END
diff --git a/src/iso19111/coordinatesystem.cpp b/src/iso19111/coordinatesystem.cpp
index 2ed2f81d..c706ad2a 100644
--- a/src/iso19111/coordinatesystem.cpp
+++ b/src/iso19111/coordinatesystem.cpp
@@ -124,6 +124,8 @@ MeridianNNPtr Meridian::create(const common::Angle &longitudeIn) {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void Meridian::_exportToWKT(
     io::WKTFormatter *formatter) const // throw(FormattingException)
@@ -166,6 +168,8 @@ void Meridian::_exportToJSON(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -360,6 +364,8 @@ CoordinateSystemAxisNNPtr CoordinateSystemAxis::create(
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void CoordinateSystemAxis::_exportToWKT(
     // cppcheck-suppress passedByValue
@@ -369,6 +375,8 @@ void CoordinateSystemAxis::_exportToWKT(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -384,6 +392,8 @@ std::string CoordinateSystemAxis::normalizeAxisName(const std::string &str) {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void CoordinateSystemAxis::_exportToWKT(io::WKTFormatter *formatter, int order,
                                         bool disableAbbrev) const {
@@ -545,6 +555,8 @@ void CoordinateSystemAxis::_exportToJSON(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -627,6 +639,8 @@ CoordinateSystem::axisList() PROJ_PURE_DEFN {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void CoordinateSystem::_exportToWKT(
     io::WKTFormatter *formatter) const // throw(FormattingException)
@@ -715,6 +729,8 @@ void CoordinateSystem::_exportToJSON(
     }
 }
 
+#endif // ENABLE_JSON
+
 //! @endcond
 
 // ---------------------------------------------------------------------------
diff --git a/src/iso19111/crs.cpp b/src/iso19111/crs.cpp
index 37d7310c..285858b2 100644
--- a/src/iso19111/crs.cpp
+++ b/src/iso19111/crs.cpp
@@ -1709,6 +1709,8 @@ bool SingleCRS::baseIsEquivalentTo(
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void SingleCRS::exportDatumOrDatumEnsembleToWkt(
     io::WKTFormatter *formatter) const // throw(io::FormattingException)
@@ -1724,6 +1726,8 @@ void SingleCRS::exportDatumOrDatumEnsembleToWkt(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -2021,6 +2025,8 @@ GeodeticCRS::create(const util::PropertyMap &properties,
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 
 // Try to format a Geographic/ProjectedCRS 3D CRS as a
@@ -2305,6 +2311,8 @@ void GeodeticCRS::_exportToWKT(io::WKTFormatter *formatter) const {
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -2512,6 +2520,8 @@ void GeodeticCRS::addDatumInfoToPROJString(
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 
 void GeodeticCRS::_exportToJSONInternal(
@@ -2567,6 +2577,8 @@ void GeodeticCRS::_exportToJSON(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -3436,6 +3448,8 @@ void GeographicCRS::_exportToPROJString(
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void GeographicCRS::_exportToJSON(
     io::JSONFormatter *formatter) const // throw(io::FormattingException)
@@ -3444,6 +3458,8 @@ void GeographicCRS::_exportToJSON(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -3569,6 +3585,8 @@ VerticalCRS::datumNonNull(const io::DatabaseContextPtr &dbContext) const {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void VerticalCRS::_exportToWKT(io::WKTFormatter *formatter) const {
     const bool isWKT2 = formatter->version() == io::WKTFormatter::Version::WKT2;
@@ -3679,6 +3697,8 @@ void VerticalCRS::_exportToWKT(io::WKTFormatter *formatter) const {
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -3709,6 +3729,8 @@ void VerticalCRS::_exportToPROJString(
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void VerticalCRS::_exportToJSON(
     io::JSONFormatter *formatter) const // throw(io::FormattingException)
@@ -3784,6 +3806,8 @@ void VerticalCRS::_exportToJSON(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -4149,6 +4173,8 @@ void DerivedCRS::setDerivingConversionCRS() {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 void DerivedCRS::baseExportToWKT(io::WKTFormatter *formatter,
                                  const std::string &keyword,
                                  const std::string &baseKeyword) const {
@@ -4208,6 +4234,8 @@ void DerivedCRS::_exportToJSON(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -4277,6 +4305,8 @@ const cs::CartesianCSNNPtr &ProjectedCRS::coordinateSystem() PROJ_PURE_DEFN {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void ProjectedCRS::_exportToWKT(io::WKTFormatter *formatter) const {
     const bool isWKT2 = formatter->version() == io::WKTFormatter::Version::WKT2;
@@ -4595,6 +4625,8 @@ void ProjectedCRS::_exportToJSON(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 void ProjectedCRS::_exportToPROJString(
@@ -5416,6 +5448,8 @@ CRSNNPtr CompoundCRS::createLax(const util::PropertyMap &properties,
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void CompoundCRS::_exportToWKT(io::WKTFormatter *formatter) const {
     const bool isWKT2 = formatter->version() == io::WKTFormatter::Version::WKT2;
@@ -5472,6 +5506,8 @@ void CompoundCRS::_exportToJSON(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 void CompoundCRS::_exportToPROJString(
@@ -6023,6 +6059,8 @@ BoundCRS::getVDatumPROJ4GRIDS(const crs::GeographicCRS *geogCRSOfCompoundCRS,
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void BoundCRS::_exportToWKT(io::WKTFormatter *formatter) const {
     const bool isWKT2 = formatter->version() == io::WKTFormatter::Version::WKT2;
@@ -6125,6 +6163,8 @@ void BoundCRS::_exportToJSON(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 void BoundCRS::_exportToPROJString(
@@ -6451,6 +6491,8 @@ DerivedGeodeticCRSNNPtr DerivedGeodeticCRS::create(
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void DerivedGeodeticCRS::_exportToWKT(io::WKTFormatter *formatter) const {
     const bool isWKT2 = formatter->version() == io::WKTFormatter::Version::WKT2;
@@ -6493,6 +6535,8 @@ void DerivedGeodeticCRS::_exportToWKT(io::WKTFormatter *formatter) const {
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 void DerivedGeodeticCRS::_exportToPROJString(
@@ -6597,6 +6641,8 @@ DerivedGeographicCRSNNPtr DerivedGeographicCRS::create(
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void DerivedGeographicCRS::_exportToWKT(io::WKTFormatter *formatter) const {
     const bool isWKT2 = formatter->version() == io::WKTFormatter::Version::WKT2;
@@ -6635,6 +6681,8 @@ void DerivedGeographicCRS::_exportToWKT(io::WKTFormatter *formatter) const {
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 void DerivedGeographicCRS::_exportToPROJString(
@@ -6825,6 +6873,8 @@ DerivedProjectedCRS::demoteTo2D(const std::string &newName,
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void DerivedProjectedCRS::_exportToWKT(io::WKTFormatter *formatter) const {
     const bool isWKT2 = formatter->version() == io::WKTFormatter::Version::WKT2;
@@ -6909,6 +6959,8 @@ void DerivedProjectedCRS::_exportToWKT(io::WKTFormatter *formatter) const {
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 bool DerivedProjectedCRS::_isEquivalentTo(
@@ -7003,6 +7055,8 @@ TemporalCRSNNPtr TemporalCRS::create(const util::PropertyMap &properties,
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void TemporalCRS::_exportToWKT(io::WKTFormatter *formatter) const {
     const bool isWKT2 = formatter->version() == io::WKTFormatter::Version::WKT2;
@@ -7049,6 +7103,8 @@ void TemporalCRS::_exportToJSON(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 bool TemporalCRS::_isEquivalentTo(
@@ -7125,6 +7181,8 @@ EngineeringCRS::create(const util::PropertyMap &properties,
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void EngineeringCRS::_exportToWKT(io::WKTFormatter *formatter) const {
     const bool isWKT2 = formatter->version() == io::WKTFormatter::Version::WKT2;
@@ -7181,6 +7239,8 @@ void EngineeringCRS::_exportToJSON(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 bool EngineeringCRS::_isEquivalentTo(
@@ -7312,6 +7372,8 @@ ParametricCRS::create(const util::PropertyMap &properties,
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void ParametricCRS::_exportToWKT(io::WKTFormatter *formatter) const {
     const bool isWKT2 = formatter->version() == io::WKTFormatter::Version::WKT2;
@@ -7359,6 +7421,8 @@ void ParametricCRS::_exportToJSON(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 bool ParametricCRS::_isEquivalentTo(
@@ -7443,6 +7507,8 @@ DerivedVerticalCRSNNPtr DerivedVerticalCRS::create(
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void DerivedVerticalCRS::_exportToWKT(io::WKTFormatter *formatter) const {
     const bool isWKT2 = formatter->version() == io::WKTFormatter::Version::WKT2;
@@ -7482,6 +7548,8 @@ void DerivedVerticalCRS::_exportToWKT(io::WKTFormatter *formatter) const {
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 void DerivedVerticalCRS::_exportToPROJString(
@@ -7589,6 +7657,8 @@ const char *DerivedCRSTemplate<DerivedCRSTraits>::className() const {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 static void DerivedCRSTemplateCheckExportToWKT(io::WKTFormatter *formatter,
                                                const std::string &crsName,
                                                bool wkt2_2019_only) {
@@ -7611,6 +7681,8 @@ void DerivedCRSTemplate<DerivedCRSTraits>::_exportToWKT(
                     DerivedCRSTraits::WKTBaseKeyword());
 }
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 template <class DerivedCRSTraits>
diff --git a/src/iso19111/datum.cpp b/src/iso19111/datum.cpp
index 79998b97..1eb88bfc 100644
--- a/src/iso19111/datum.cpp
+++ b/src/iso19111/datum.cpp
@@ -110,6 +110,8 @@ struct Datum::Private {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 void Datum::Private::exportAnchorDefinition(io::WKTFormatter *formatter) const {
     if (anchorDefinition) {
         formatter->startNode(io::WKTConstants::ANCHOR, false);
@@ -153,6 +155,8 @@ void Datum::Private::exportAnchorEpoch(io::JSONFormatter *formatter) const {
     }
 }
 
+#endif // ENABLE_JSON
+
 //! @endcond
 
 // ---------------------------------------------------------------------------
@@ -409,6 +413,8 @@ const PrimeMeridianNNPtr PrimeMeridian::createPARIS() {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void PrimeMeridian::_exportToWKT(
     io::WKTFormatter *formatter) const // throw(FormattingException)
@@ -507,6 +513,8 @@ void PrimeMeridian::_exportToJSON(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -877,6 +885,8 @@ const EllipsoidNNPtr Ellipsoid::createGRS1980() {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void Ellipsoid::_exportToWKT(
     io::WKTFormatter *formatter) const // throw(FormattingException)
@@ -1003,6 +1013,8 @@ void Ellipsoid::_exportToJSON(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 bool Ellipsoid::lookForProjWellKnownEllps(std::string &projEllpsName,
@@ -1351,6 +1363,8 @@ const GeodeticReferenceFrameNNPtr GeodeticReferenceFrame::createEPSG_6326() {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void GeodeticReferenceFrame::_exportToWKT(
     io::WKTFormatter *formatter) const // throw(FormattingException)
@@ -1529,6 +1543,8 @@ void GeodeticReferenceFrame::_exportToJSON(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -1750,6 +1766,8 @@ bool DynamicGeodeticReferenceFrame::_isEquivalentTo(
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void DynamicGeodeticReferenceFrame::_exportToWKT(
     io::WKTFormatter *formatter) const // throw(FormattingException)
@@ -1773,6 +1791,8 @@ void DynamicGeodeticReferenceFrame::_exportToWKT(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 /** \brief Instantiate a DynamicGeodeticReferenceFrame
@@ -1931,6 +1951,8 @@ DatumEnsemble::asDatum(const io::DatabaseContextPtr &dbContext) const {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void DatumEnsemble::_exportToWKT(
     io::WKTFormatter *formatter) const // throw(FormattingException)
@@ -2037,6 +2059,8 @@ void DatumEnsemble::_exportToJSON(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 /** \brief Instantiate a DatumEnsemble.
@@ -2201,6 +2225,8 @@ const std::string &VerticalReferenceFrame::getWKT1DatumType() const {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void VerticalReferenceFrame::_exportToWKT(
     io::WKTFormatter *formatter) const // throw(FormattingException)
@@ -2266,6 +2292,8 @@ void VerticalReferenceFrame::_exportToWKT(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -2432,6 +2460,8 @@ bool DynamicVerticalReferenceFrame::_isEquivalentTo(
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void DynamicVerticalReferenceFrame::_exportToWKT(
     io::WKTFormatter *formatter) const // throw(FormattingException)
@@ -2454,6 +2484,8 @@ void DynamicVerticalReferenceFrame::_exportToWKT(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 /** \brief Instantiate a DynamicVerticalReferenceFrame
@@ -2552,6 +2584,8 @@ TemporalDatum::create(const util::PropertyMap &properties,
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void TemporalDatum::_exportToWKT(
     io::WKTFormatter *formatter) const // throw(FormattingException)
@@ -2584,6 +2618,8 @@ void TemporalDatum::_exportToWKT(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -2627,6 +2663,8 @@ bool TemporalDatum::_isEquivalentTo(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -2663,6 +2701,8 @@ EngineeringDatum::create(const util::PropertyMap &properties,
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void EngineeringDatum::_exportToWKT(
     io::WKTFormatter *formatter) const // throw(FormattingException)
@@ -2723,6 +2763,8 @@ bool EngineeringDatum::_isEquivalentTo(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -2759,6 +2801,8 @@ ParametricDatum::create(const util::PropertyMap &properties,
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void ParametricDatum::_exportToWKT(
     io::WKTFormatter *formatter) const // throw(FormattingException)
diff --git a/src/iso19111/io.cpp b/src/iso19111/io.cpp
index 0e8f9e48..c2679904 100644
--- a/src/iso19111/io.cpp
+++ b/src/iso19111/io.cpp
@@ -65,7 +65,9 @@
 #include "proj/internal/internal.hpp"
 #include "proj/internal/io_internal.hpp"
 
+#ifdef ENABLE_JSON
 #include "proj/internal/include_nlohmann_json.hpp"
+#endif // ENABLE_JSON
 
 #include "proj_constants.h"
 
@@ -89,7 +91,9 @@ using namespace NS_PROJ::metadata;
 using namespace NS_PROJ::operation;
 using namespace NS_PROJ::util;
 
+#ifdef ENABLE_JSON
 using json = nlohmann::json;
+#endif // ENABLE_JSON
 
 //! @cond Doxygen_Suppress
 static const std::string emptyString{};
@@ -119,6 +123,8 @@ const char *JSONFormatter::PROJJSON_v0_7 =
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 IWKTExportable::~IWKTExportable() = default;
 
@@ -129,6 +135,8 @@ std::string IWKTExportable::exportToWKT(WKTFormatter *formatter) const {
     return formatter->toString();
 }
 
+#endif // ENABLE_JSON
+
 //! @endcond
 
 // ---------------------------------------------------------------------------
@@ -7664,6 +7672,7 @@ static BaseObjectNNPtr createFromUserInput(const std::string &text,
         }
     }
 
+#ifdef ENABLE_JSON
     if (!text.empty() && text[0] == '{') {
         json j;
         try {
@@ -7673,6 +7682,7 @@ static BaseObjectNNPtr createFromUserInput(const std::string &text,
         }
         return JSONParser().attachDatabaseContext(dbContext).create(j);
     }
+#endif // ENABLE_JSON
 
     if (!ci_starts_with(text, "step proj=") &&
         !ci_starts_with(text, "step +proj=")) {
@@ -12829,6 +12839,8 @@ PROJStringParser::createFromPROJString(const std::string &projString) {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 struct JSONFormatter::Private {
     CPLJSonStreamingWriter writer_{nullptr, nullptr};
@@ -13022,5 +13034,7 @@ std::string IJSONExportable::exportToJSON(JSONFormatter *formatter) const {
 
 //! @endcond
 
+#endif // ENABLE_JSON
+
 } // namespace io
 NS_PROJ_END
diff --git a/src/iso19111/metadata.cpp b/src/iso19111/metadata.cpp
index 60751075..51ebd24b 100644
--- a/src/iso19111/metadata.cpp
+++ b/src/iso19111/metadata.cpp
@@ -38,7 +38,9 @@
 #include "proj/internal/internal.hpp"
 #include "proj/internal/io_internal.hpp"
 
+#ifdef ENABLE_JSON
 #include "proj_json_streaming_writer.hpp"
+#endif
 
 #include <algorithm>
 #include <cmath>
@@ -1104,6 +1106,8 @@ const optional<std::string> &Identifier::uri() PROJ_PURE_DEFN {
     return d->uri_;
 }
 
+#ifdef ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -1202,6 +1206,8 @@ void Identifier::_exportToJSON(JSONFormatter *formatter) const {
 
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
diff --git a/src/iso19111/operation/concatenatedoperation.cpp b/src/iso19111/operation/concatenatedoperation.cpp
index 112ed758..6cf880a2 100644
--- a/src/iso19111/operation/concatenatedoperation.cpp
+++ b/src/iso19111/operation/concatenatedoperation.cpp
@@ -788,6 +788,8 @@ CoordinateOperationNNPtr ConcatenatedOperation::inverse() const {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void ConcatenatedOperation::_exportToWKT(io::WKTFormatter *formatter) const {
     const bool isWKT2 = formatter->version() == io::WKTFormatter::Version::WKT2;
@@ -893,6 +895,8 @@ void ConcatenatedOperation::_exportToJSON(
 
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
diff --git a/src/iso19111/operation/conversion.cpp b/src/iso19111/operation/conversion.cpp
index 60a8eaf9..543ea038 100644
--- a/src/iso19111/operation/conversion.cpp
+++ b/src/iso19111/operation/conversion.cpp
@@ -3583,6 +3583,8 @@ void Conversion::_exportToJSON(
 
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
diff --git a/src/iso19111/operation/coordinateoperation_internal.hpp b/src/iso19111/operation/coordinateoperation_internal.hpp
index d890f710..8e111f2a 100644
--- a/src/iso19111/operation/coordinateoperation_internal.hpp
+++ b/src/iso19111/operation/coordinateoperation_internal.hpp
@@ -100,6 +100,7 @@ class InverseConversion : public Conversion, public InverseCoordinateOperation {
 
     ~InverseConversion() override;
 
+#ifdef ENABLE_JSON
     void _exportToWKT(io::WKTFormatter *formatter) const override {
         Conversion::_exportToWKT(formatter);
     }
@@ -107,6 +108,7 @@ class InverseConversion : public Conversion, public InverseCoordinateOperation {
     void _exportToJSON(io::JSONFormatter *formatter) const override {
         Conversion::_exportToJSON(formatter);
     }
+#endif // ENABLE_JSON
 
     void
     _exportToPROJString(io::PROJStringFormatter *formatter) const override {
@@ -156,16 +158,20 @@ class InverseTransformation : public Transformation,
 
     ~InverseTransformation() override;
 
+#ifdef ENABLE_JSON
     void _exportToWKT(io::WKTFormatter *formatter) const override;
+#endif // ENABLE_JSON
 
     void
     _exportToPROJString(io::PROJStringFormatter *formatter) const override {
         return InverseCoordinateOperation::_exportToPROJString(formatter);
     }
 
+#ifdef ENABLE_JSON
     void _exportToJSON(io::JSONFormatter *formatter) const override {
         Transformation::_exportToJSON(formatter);
     }
+#endif // ENABLE_JSON
 
     bool _isEquivalentTo(
         const util::IComparable *other,
@@ -214,8 +220,10 @@ class PROJBasedOperation : public SingleOperation {
   public:
     ~PROJBasedOperation() override;
 
+#ifdef ENABLE_JSON
     void _exportToWKT(io::WKTFormatter *formatter)
         const override; // throw(io::FormattingException)
+#endif // ENABLE_JSON
 
     CoordinateOperationNNPtr inverse() const override;
 
@@ -243,8 +251,10 @@ class PROJBasedOperation : public SingleOperation {
     void _exportToPROJString(io::PROJStringFormatter *formatter)
         const override; // throw(FormattingException)
 
+#ifdef ENABLE_JSON
     void _exportToJSON(io::JSONFormatter *formatter)
         const override; // throw(FormattingException)
+#endif // ENABLE_JSON
 
     CoordinateOperationNNPtr _shallowClone() const override;
 
diff --git a/src/iso19111/operation/oputils.cpp b/src/iso19111/operation/oputils.cpp
index 60bdb09e..b0a78096 100644
--- a/src/iso19111/operation/oputils.cpp
+++ b/src/iso19111/operation/oputils.cpp
@@ -594,6 +594,8 @@ double getAccuracy(const std::vector<CoordinateOperationNNPtr> &ops) {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 void exportSourceCRSAndTargetCRSToWKT(const CoordinateOperation *co,
                                       io::WKTFormatter *formatter) {
     auto l_sourceCRS = co->sourceCRS();
@@ -639,6 +641,8 @@ void exportSourceCRSAndTargetCRSToWKT(const CoordinateOperation *co,
     }
 }
 
+#endif // ENABLE_JSON
+
 //! @endcond
 
 // ---------------------------------------------------------------------------
diff --git a/src/iso19111/operation/projbasedoperation.cpp b/src/iso19111/operation/projbasedoperation.cpp
index 8fb8c6ae..8ed5c74e 100644
--- a/src/iso19111/operation/projbasedoperation.cpp
+++ b/src/iso19111/operation/projbasedoperation.cpp
@@ -191,6 +191,8 @@ CoordinateOperationNNPtr PROJBasedOperation::inverse() const {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 void PROJBasedOperation::_exportToWKT(io::WKTFormatter *formatter) const {
 
     if (sourceCRS() && targetCRS()) {
@@ -259,6 +261,8 @@ void PROJBasedOperation::_exportToJSON(
     }
 }
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 void PROJBasedOperation::_exportToPROJString(
diff --git a/src/iso19111/operation/singleoperation.cpp b/src/iso19111/operation/singleoperation.cpp
index 125039a6..601ed62f 100644
--- a/src/iso19111/operation/singleoperation.cpp
+++ b/src/iso19111/operation/singleoperation.cpp
@@ -681,6 +681,8 @@ int OperationMethod::getEPSGCode() PROJ_PURE_DEFN {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void OperationMethod::_exportToWKT(io::WKTFormatter *formatter) const {
     const bool isWKT2 = formatter->version() == io::WKTFormatter::Version::WKT2;
@@ -714,6 +716,8 @@ void OperationMethod::_exportToWKT(io::WKTFormatter *formatter) const {
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -733,6 +737,8 @@ void OperationMethod::_exportToJSON(
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -875,6 +881,8 @@ OperationParameterValue::parameterValue() PROJ_PURE_DEFN {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void OperationParameterValue::_exportToWKT(
     // cppcheck-suppress passedByValue
@@ -1138,8 +1146,12 @@ bool OperationParameter::_isEquivalentTo(
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 void OperationParameter::_exportToWKT(io::WKTFormatter *) const {}
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 /** \brief Return the name of a parameter designed by its EPSG code
@@ -2297,6 +2309,8 @@ createNTv1(const util::PropertyMap &properties,
 }
 //! @endcond
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -2994,6 +3008,8 @@ SingleOperation::createOperationParameterValueFromInterpolationCRS(
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 void SingleOperation::exportTransformationToWKT(
     io::WKTFormatter *formatter) const {
     const bool isWKT2 = formatter->version() == io::WKTFormatter::Version::WKT2;
@@ -3073,6 +3089,8 @@ void SingleOperation::exportTransformationToWKT(
     formatter->endNode();
 }
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
diff --git a/src/iso19111/operation/transformation.cpp b/src/iso19111/operation/transformation.cpp
index 4319e331..da30a6f4 100644
--- a/src/iso19111/operation/transformation.cpp
+++ b/src/iso19111/operation/transformation.cpp
@@ -1391,6 +1391,8 @@ static double negate(double val) {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 static CoordinateOperationPtr
 createApproximateInverseIfPossible(const Transformation *op) {
     bool sevenParamsTransform = false;
@@ -1535,6 +1537,8 @@ createApproximateInverseIfPossible(const Transformation *op) {
     return nullptr;
 }
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 //! @cond Doxygen_Suppress
@@ -1805,6 +1809,8 @@ TransformationNNPtr InverseTransformation::inverseAsTransformation() const {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 void InverseTransformation::_exportToWKT(io::WKTFormatter *formatter) const {
 
     auto approxInverse = createApproximateInverseIfPossible(
@@ -1816,6 +1822,8 @@ void InverseTransformation::_exportToWKT(io::WKTFormatter *formatter) const {
     }
 }
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 CoordinateOperationNNPtr InverseTransformation::_shallowClone() const {
@@ -1830,6 +1838,8 @@ CoordinateOperationNNPtr InverseTransformation::_shallowClone() const {
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 //! @cond Doxygen_Suppress
 void Transformation::_exportToWKT(io::WKTFormatter *formatter) const {
     exportTransformationToWKT(formatter);
@@ -1910,6 +1920,8 @@ void Transformation::_exportToJSON(
     }
 }
 
+#endif // ENABLE_JSON
+
 //! @endcond
 
 // ---------------------------------------------------------------------------
diff --git a/src/lib_proj.cmake b/src/lib_proj.cmake
index fac9d0e8..3281825c 100644
--- a/src/lib_proj.cmake
+++ b/src/lib_proj.cmake
@@ -157,8 +157,6 @@ set(SRC_LIBPROJ_TRANSFORMATIONS
   transformations/molodensky.cpp
   transformations/vgridshift.cpp
   transformations/xyzgridshift.cpp
-  transformations/defmodel.cpp
-  transformations/tinshift.cpp
   transformations/vertoffset.cpp
 )
 
diff --git a/src/pj_list.h b/src/pj_list.h
index b813f989..73e1de2f 100644
--- a/src/pj_list.h
+++ b/src/pj_list.h
@@ -162,7 +162,9 @@ PROJ_HEAD(gstmerc,
 PROJ_HEAD(tcc, "Transverse Central Cylindrical")
 PROJ_HEAD(tcea, "Transverse Cylindrical Equal Area")
 PROJ_HEAD(times, "Times Projection")
+#ifdef ENABLE_JSON
 PROJ_HEAD(tinshift, "Triangulation based transformation")
+#endif // ENABLE_JSON
 PROJ_HEAD(tissot, "Tissot Conic")
 PROJ_HEAD(tmerc, "Transverse Mercator")
 PROJ_HEAD(tobmerc, "Tobler-Mercator")
diff --git a/src/transformations/defmodel.cpp b/src/transformations/defmodel.cpp
index 87ae8789..4763db38 100644
--- a/src/transformations/defmodel.cpp
+++ b/src/transformations/defmodel.cpp
@@ -385,6 +385,8 @@ static void reassign_context(PJ *P, PJ_CONTEXT *ctx) {
     }
 }
 
+#ifdef ENABLE_JSON
+
 PJ *PJ_TRANSFORMATION(defmodel, 1) {
     // Pass a dummy ellipsoid definition that will be overridden just afterwards
     auto cart = proj_create(P->ctx, "+proj=cart +a=1");
@@ -448,3 +450,5 @@ PJ *PJ_TRANSFORMATION(defmodel, 1) {
 
     return P;
 }
+
+#endif // ENABLE_JSON
diff --git a/src/transformations/defmodel.hpp b/src/transformations/defmodel.hpp
index 906fe868..adf41bf2 100644
--- a/src/transformations/defmodel.hpp
+++ b/src/transformations/defmodel.hpp
@@ -36,11 +36,13 @@
 #ifndef DEFMODEL_HPP
 #define DEFMODEL_HPP
 
+#ifdef ENABLE_JSON
 #ifdef PROJ_COMPILATION
 #include "proj/internal/include_nlohmann_json.hpp"
 #else
 #include "nlohmann/json.hpp"
 #endif
+#endif // ENABLE_JSON
 
 #include <algorithm>
 #include <cmath>
diff --git a/src/transformations/defmodel_impl.hpp b/src/transformations/defmodel_impl.hpp
index fbf994a9..079e0596 100644
--- a/src/transformations/defmodel_impl.hpp
+++ b/src/transformations/defmodel_impl.hpp
@@ -267,6 +267,8 @@ double Epoch::toDecimalYear() const { return mDecimalYear; }
 
 // ---------------------------------------------------------------------------
 
+#ifdef ENABLE_JSON
+
 static std::string getString(const json &j, const char *key, bool optional) {
     if (!j.contains(key)) {
         if (optional) {
@@ -619,6 +621,8 @@ Component Component::parse(const json &j) {
     return comp;
 }
 
+#endif // ENABLE_JSON
+
 // ---------------------------------------------------------------------------
 
 double Component::ConstantTimeFunction::evaluateAt(double) const { return 1.0; }
